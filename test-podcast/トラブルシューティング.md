# セキュリティポッドキャスト生成 トラブルシューティングガイド

このガイドでは、セキュリティポッドキャスト生成プログラムで発生する可能性のある一般的な問題と解決策を紹介します。

## 一般的なエラーと解決策

### 1. OpenAI API キーの問題

**症状**:
```
OPENAI_API_KEY環境変数が設定されていません
```
または
```
Error code: 401 - {'error': {'message': 'Incorrect API key provided'...
```

**解決策**:
1. `.env` ファイルが正しい場所にあるか確認する
2. `.env` ファイル内に `OPENAI_API_KEY=your_api_key_here` の形式で正しいAPIキーが設定されているか確認する
3. キーが有効であるか OpenAI のウェブサイトでアカウント状態を確認する

### 2. RSSフィードからの記事取得失敗

**症状**:
```
RSS取得成功: 0件のエントリを検出
```

**解決策**:
1. インターネット接続を確認する
2. `main_with_summary.py` 内の RSS_URL が正しいか確認する（現在は `https://rocket-boys.co.jp/feed/`）
3. Webサイトから直接記事取得するフォールバック機能が動作するか確認する

### 3. Webスクレイピング失敗

**症状**:
```
記事の取得に失敗しました
```

**解決策**:
1. インターネット接続を確認する
2. `main_with_summary.py` 内の SITE_URL が正しいか確認する（現在は `https://rocket-boys.co.jp/security-measures-lab/`）
3. Webサイトの構造が変更された可能性がある場合は、`get_articles_from_website` 関数を更新する

### 4. FFmpeg関連の問題

**症状**:
```
FFmpegエラー: ...
```
または
```
BGMミックス失敗のため、ミックスなしのファイルを使用します
```

**解決策**:
1. FFmpeg がインストールされているか確認する
2. FFmpeg が PATH 環境変数に追加されているか確認する
3. BGM ファイルが指定のパスに存在するか確認する
4. コマンドラインで直接 FFmpeg を実行してみて、エラーがないか確認する

### 5. パスまたはディレクトリの問題

**症状**:
```
FileNotFoundError: [Errno 2] No such file or directory: ...
```
または
```
PermissionError: [Errno 13] Permission denied: ...
```

**解決策**:
1. 必要なディレクトリ（`scripts`、`output`、`temp`、`output/要約`）が存在するか確認する
2. 各ディレクトリに書き込み権限があるか確認する
3. パスに特殊文字やスペースがある場合、正しくエスケープされているか確認する

### 6. OpenAI API のパラメータエラー

**症状**:
```
Error code: 400 - {'error': {'message': 'Bad request'...
```
または
```
Error code: 400 - {'error': {'message': "Unsupported parameter: 'max_tokens' is not supported...
```

**解決策**:
1. OpenAI の API 仕様が変更された可能性がある場合は、最新のドキュメントを確認して適切なパラメータを使用する
2. OpenAI のモデル名が正しいことを確認する（現在は「o3-mini」や「tts-1」）

### 7. 要約生成の問題

**症状**:
```
要約の生成に失敗しました
```
または
```
APIエラーのため単純な要約を生成しました
```

**解決策**:
1. スクリプトファイルが正しく保存されているか確認する
2. OpenAI API キーが有効であるか確認する
3. スクリプトの長さが制限を超えているか確認し、必要に応じて短くする

## ログファイルの確認方法

問題が発生した場合は、以下のログファイルを確認して詳細な情報を得ることができます：

1. **podcast_run_log.txt**: バッチファイル実行時の標準出力・エラー出力
2. **podcast_generator.log**: プログラム内部のログメッセージ

これらのログファイルには、エラーメッセージや警告メッセージなど、問題解決に役立つ情報が含まれています。

## その他の注意点

1. **OpenAI API 利用コスト**:
   - 頻繁にプログラムを実行すると、予想以上のAPIコストが発生する可能性があります
   - API使用状況を定期的に確認してください

2. **インターネット接続**:
   - プログラムの実行には安定したインターネット接続が必要です
   - VPN使用時や接続が不安定な場合にエラーが発生する可能性があります

3. **更新とメンテナンス**:
   - ウェブサイトの構造は時間とともに変化する可能性があるため、スクレイピングロジックは定期的に確認が必要です
   - OpenAI APIの仕様も変更される可能性があるため、適宜コードを更新してください

4. **システムリソース**:
   - 処理中に一時的にディスク容量や CPU 使用率が増加することがあります
   - 十分なシステムリソースが利用可能な状態で実行してください
